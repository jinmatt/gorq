language: go

secure: "Ht1X0+d0mJ/3h/CNtJqXEUhEByPYhEN5YbIej8T2XSDJrKtD6fqQHJlikUoi3CFlSC6r1vktMz9brZRFE6TMybwbsUU3EpYp7Ip+v2NOvz3BvJ1V+MKaDKUIV6Hb5g6D3mY9Huy4X1FbpUknD2izWkQnA+9/3VUrMwX7Jcwz3VY="

go:
  - tip

services:
  - mysql
  - postgres
  - sqlite3

before_script:
  - mysql -e "CREATE DATABASE gorptest;"
  - mysql -u root -e "GRANT ALL ON gorptest.* TO gorptest@localhost IDENTIFIED BY 'gorptest'"
  - psql -c "CREATE USER gorptest PASSWORD 'gorptest';" -U postgres
  - psql -c "CREATE DATABASE gorptest OWNER gorptest;" -U postgres
  - go list -f '{{range .TestImports}}{{.}} {{end}}' . | xargs go get
  - go get code.google.com/p/go.tools/cmd/cover
  - go get github.com/mattn/goveralls

script:
  - go test -v -covermode=count -coverprofile=coverage.out
  - $HOME/gopath/bin/goveralls -coverprofile=coverage.out -service=travis-ci $COVERALLS_TOKEN
